@{
    ViewData["Title"] = "Eliminar Asistente";
    Layout = "_LayoutInterno";
    var open = (bool?)ViewBag.OpenModal ?? false;
    var id = (int?)ViewBag.AsistenteId;
}

<h1 class="mt-4">Eliminar Asistente</h1>

<!-- Modal de confirmación -->
<div class="modal fade" id="modalEliminar" tabindex="-1" aria-labelledby="modalEliminarLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title fw-bold" id="modalEliminarLabel">
                    <i class="fas fa-trash-alt me-2"></i>Confirmar eliminación
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <p class="mb-1">¿Está seguro que desea eliminar este registro?</p>
               
            </div>
            <div class="modal-footer">
                <!-- No realiza acción real: solo navega de regreso -->
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                <button type="button" id="btnConfirmDelete" class="btn btn-danger">
                    Sí, eliminar
                </button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const fromServer = @(open.ToString().ToLower());
            const url = new URL(window.location.href);
            const fromQuery = url.searchParams.get('openModal') === 'true';
            const fromHash  = window.location.hash === '#modalEliminar';

            const modalEl = document.getElementById('modalEliminar');
            if (modalEl && (fromServer || fromQuery || fromHash)) {
                const modal = new bootstrap.Modal(modalEl);
                modal.show();

                // Al cerrar (X o No), volver al listado
                modalEl.addEventListener('hidden.bs.modal', function () {
                    window.location.href = '@Url.Action("ConsultarAsistente", "Asistente")';
                });

                // Al confirmar (Sí), por ahora también volver al listado (sin eliminar)
                document.getElementById('btnConfirmDelete')?.addEventListener('click', function () {
                    // En el futuro: llamar fetch/POST al procedimiento almacenado
                    window.location.href = '@Url.Action("ConsultarAsistente", "Asistente")';
                });
            }
        });
    </script>
}
